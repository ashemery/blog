---
title: Howto upgrade Debian from any version to Debian Lenny
date: 2009-10-25 07:37:26 -0500
categories:
- GNU/Linux
tags:
- debian
- etch
- howto
- lenny
- upgrade
permalink: /2009/10/25/howto-upgrade-debian-from-any-version-to-debian-lenny/
reading_time: 4
---
السلام عليكم ورحمة الله وبركاته

هذا أيضاً مستند بسيط قمت بكتابته لأغراض العمل وأتوقع إنكم ممكن تستفيدو منه … عملية الترقية في نظام Debian الى نسخة أحدث ليست بالصعبة لكن هناك حاجة بسيطة يغفل عليها بعض المواقع التي يشرحون الطريقة ولعل السبب التي لا تظهر عندهم المشكلة إنهم دائماً يحدثون نظامهم من النسخة القديمة الى النسخة الحديثة حال صدورها … أنا وجدت قبل فترة إن لدينا في العمل أكثر من خادم غير محدث ربما منذ حوالي العام !!! ولهذا وجدت عندنا أنظمة Debian Etch ورقمها هو على ما اذكر 4.7 … وحالياً يوجد Debian Lenny والذي رقمه هو 5.0.3 … يعني مسافة كبيرة بين الأول والثاني …

لهذا لنبدأ عملية الترقية معاً … أول حاجة قم بعملها هو أخذ نسخة إحتياطية من نظامك أو الملفات التي على نظامك حسب نظام النسخ الإحتياطية التي تستعملونه … بعد ذلك قم بتنفيذ الأمر التالي:

sudo apt-get install debian-archive-keyring

هذا هو الأمر بصراحة الذي يخطأ أو لنقل بعبارة أصح ينسون ذكره حين يشرحون عملية التحديث للنظام وهو الذي حسب الموسوعة الخاصة بالدبيان يقوم بعملية توزيع المفاتيح الى البرنامج apt، كما ينص الموقع:

اقتباس:

> The debian-archive-keyring package is used to distribute keys to apt. Upgrades to this package can add (or remove) gpg keys for the main Debian archive.

النص مأخوذ من موسوعة دبيان من [هنا](http://wiki.debian.org/SecureApt) … في جزئية How to find a key …

طبعاً قم بالموافقة على المفاتيح الجديدة ومن ثم أكمل معي التحديث …

الآن أظن سيكون باقي الشرح مثله مثل باقي المواقع ولكن سنكمل لكي يكون الموضوع مرجع لنا جميعاً (أو لمن أراد ذلك ) … الآن قم بعمل التالي:

apt-get update

apt-get upgrade

إذا حدث وتنصب لديك نواة جديدة خلال عملية التحديث الأولية هذه (وهو متوقع إن كنت تقوم بتحديث نظام قديم جداً مثلي الى نظام حديث) ؟ قم بعمل إعادة تشغيل للنظام لكي تستخدم النواة الجديدة … وبعدها أكمل معي … الآن قم بأخذ نسخة إحتياطية من ملف sources.list كما يلي:

cp /etc/apt/sources.list /etc/apt/sources.list.bak

بعدها لنقم بتحرير ملف sources.list لإضافة الروابط الجديدة:

vim /etc/apt/sources.list

وأحذف التي بداخل الملف وضع التالي:

# Main

deb http://http.us.debian.org/debian/ stable main non-free contrib

# Source

deb-src http://http.us.debian.org/debian/ stable main non-free contrib

# Security

deb http://security.debian.org/ stable/updates main contrib non-free

هنا أخترنا التحميل من المخازن الرئيسية والتي هي خوادم بامريكا … قم بالبحث عن أقرب دولة لجهازك الذي تريد تحديثه وذلك لكي تتم العملية بسرعة … لأنني في البداية أستعملت مخازن بعيدة وكان المقرر أن ينتهي التحديث بحوالي ساعة بينما حين إستعملت مسارات قريبة أنتهت التحديث بعشرة دقائق فقط !!!

الآن نفذ التالي:

aptitude update

apt-get install apt aptitude

سيقول لك بإن بعض الخدمات تحتاج الى إعادة تشغيل مثل ssh عادي وافق على إعادة تشغيلها … واكمل معي … الآن نفذ هذه الأوامر ثاني:

apt-get update

apt-get upgrade

وبعدها نفذ أمر التحديث للنظام الجديد Lenny:

aptitude dist-upgrade

أو هذا:

apt-get dist-upgrade

بعد أن ينتهي كل شيء إذا كان هناك تنصيب لنواة جديدة قم بعمل إعادة تشغيل لتستعمل النواة الجديدة ومن ثم تأكد من ذلك من خلال:

uname -a

وللتأكد إنك تستعمل النظام الجديد Debian Lenny نسخة 5.0.3، نفذ التالي:

cat /etc/debian_version

كل شيء تمام؟ مبروك عليك النظام الجديد …

**نقطة مهمة جداً جداً:**

إذا كان على الخادم خدمات ذات إعدادات معينة ؟ عملية النسخ الإحتياطي لإعداداتها ربما لن تفيدك كثيراً خاصة إذا كانت النسخة الحديثة من هذه الخدمة تستعمل أسلوب وطريقة تعامل أخرى … وهذا حدث معي عندما قمت بعمل تحديث النظام حيث إن Nagios 2 هو المستعمل بينما حالياً يوجد Nagios 3 ولهذا حالياً جاري العمل على عمل Migrate من الإعدادات القديمة لنظام المراقبة الى الإعدادات الحديثة … حيث هنا لم يفيدني الـ Configuration Management التي أستعمله بسبب إن الفرق هو بالنسخة حق Nagios نفسها وليس بالنظام وما الى ذلك …

إن شاء الله قريباً أشرح كيفية عمل Subversion Repository لتستعمله كـ Configuration Manager وتستطيع حفظ جميع التغييرات التي تتم على إعدادات نظامك …

للنقاش [هنا](https://www.linuxac.org/forum/linuxac7/thread31469.html) …

بالتوفيق للجميع …
