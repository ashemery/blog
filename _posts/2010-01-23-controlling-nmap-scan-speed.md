---
title: "Controlling Nmap Scan Speed"
date: 2010-01-23 15:54:57 -0500
categories: ["Firewalls", "Footprinting", "IDS/IPS", "Networks", "PenTest"]
tags: ["IDS", "nmap", "Scan", "Scanner"]
permalink: "/2010/01/23/controlling-nmap-scan-speed/"
reading_time: 4
---

**السلام عليكم ورحمة الله وبركاته**

موضوع الأخ مصطفى ذكرني أكتب عن **nmap** والتي هي أفضل Scanner بأن أقوم بكتابة القليل عن هذه الأداة الرائعة …

بعض الأحيان حين تقوم بعمل فحص على هدف ما تحتاج الى أن تكون بطيء الى حد ما أو ربما تحتاج الى سرعة إضافية أثناء عملية الفحص … جميع هذه الطلبات يوفرها لك **nmap** من خلال خيارات عدة …

أهم  5 خيارات أو الأكثر شيوعاً هي:

**Paranoid**: هذا الخيار يقوم بإرسال الحزم كل خمسة دقائق وذلك لكي تكون خارج مجال الـ Time Sample الخاص بالـ IDS (في حالة كان هناك واحد على الهدف) وبالتالي يصعب إكتشاف الشخص الذي يقوم بعملية الفحص … هذه الطريقة تقوم بإرسال الحزم بشكل متسلسل Sequential وليس بشكل متزامن أو متوازي Parallel … أي حزمة بعد حزمة وهكذا …

**Sneaky**: يقوم بإرسال الحزم كل 15 ثانية … وكما في الطريقة السابقة لا يتم الإرسال بشكل متوازي وإنما حزمة بعد حزمة …

**Polite**: يتم إرسال الحزمة كل 0.4 ثانية، وأيضاً حزمة بعد حزمة … تم عمل هذا الخيار من أجل تخفيف الضغط على الشبكات حين تتم عملية الفحص ولكي لا تسبب بإنهيار الطرف المستهدف …

**Normal**: هذه هي الطريقة الأساسية التي يعتمدها الفاحص nmap … تعمل بشكل سريع جداً لكن بنفس الوقت لا تقوم بإغراق الجهة المستهدفة أو الشبكة … تحاول هذه الطريقة أن تكتشف أكبر قدر ممكن من الأجهزة والمنافذ المفتوحة … هذه الطريقة تقوم بإرسال الحزم بشكل متوازي Parallel أي مجموعة حزم ترسل الى مجموعة منافذ مرة واحدة وهكذا …

**Aggressive**: في هذه الطريقة تقوم nmap بفحص الجهة المستهدفة خلال 5 دقائق فقط بعدها تنتقل للهدف الآخر … هذه الطريقة تنتظر 1.25 ثانية من أجل الحصول على جواب … يعني حين تقوم بالفحص إذا لم يأتي جواب خلال هذه الفترة، تعتبر الجهة أو المنفذ مغلق وتنتقل للفحص التالي … طبعاً من دون أن أذكر أو أوضح، هذه الطريقة واضح إنها تستعمل Parallel في عملية إرسال الحزم …

**Insane**: في هذه الطريقة تقوم nmap بفحص الجهة المستهدفة خلال 75 ثانية فقط بعدها تنتقل للهدف الآخر … وتنتظر حوالي 0.3 ثانية للحصول على جواب … طبعاً هذه الطريقة ربما لا تستطيع إكتشاف الكثير من الأهداف وذلك للسرعة العالية التي تنفذ بها … ولهذا ينصح إستعمالها على الشبكات السريعة جداً جداً … وأيضاً نقطة أخيرة وهي بإنه ممكن هذه الطريقة تعمل مشاكل على الشبكة “غرق الشبكة” والجهة المستهدفة أيضاً بسبب سرعتها العالية …

الآن لإستعمال أي من هذه الخيارات، فالصيغة العامة هي:

كود:

```
nmap -T MODENAME/MODE# [other options] target
```

**مثال:**

```
nmap -T Paranoid -p80,22,443 example.com
```

أو  إستعمال أرقام هذه الخيارات والتي هي من 0 (Paranoid) الى 5 (Insane) كما في المثال التالي:

```
nmap -T 4 -p80,22,443 example.com
```

هذه الخيارات رائعة جداً ومفيدة جداً بنفس الوقت … لكن إن كنت تريد الحصول على دقة أكثر في إعداداتك؟ إذن تابع معي لنستعرض خيارات أخرى لـ **nmap** …

**–host_timeout**

هنا تحدد أقصى فترة زمنية بالـ millisecond التي يستغرقها nmap في فحص هدف قبل أن ينتقل للهدف الآخر “في حالة فحص أهداف عدة معا”. القيمة الإفتراضية هي لا وجود للـ timeout …

**–max_rtt_timeout**

وهي أقصى فترة زمنية للإنتظار لجواب فحص قبل أن تقوم بإعادة الإرسال أو تحديد إنه timeout … القيمة الإفتراضية هي 9000 millisecond …

**–min_rtt_timeout**

عندما يبدأ nmap بفحص الجهة المستهدفة فإنه يقوم بعمليات حسابية لقياس الفترة الزمنية التي جالس تستغرق للحصول على أجوبة على الحزم المرسلة وبالتالي يقوم بتحديد فترة زمنية يقييس عليها … من خلال هذا الخيار تستطيع أن تقوم أنت بتحديد هذه الفترة الزمنية لكي لا يقل الـ timeout عنه وتحصل على أفضل النواتج …

**–initial_rtt_timeout**

هنا تحدد القيمة الإفتراضية للـ timeout والتي بدون شك سيقوم nmap بتقليلها بعدما يقوم بإحتساب الفترة الزمنية التي يحتاجها للحصول على اجوبة من الجهة المستهدفة … القيمة الإفتراضية هنا هي 6000 millisecond …

**–max_parallelism**

هنا تحدد عدد الفحوصات التي تتم بالمرة الواحدة … إذا قمت بإختيار 1، فإنه سيتم فحص هدف بعد هدف (سواءاً جهاز او منفذ) …

**–scan_delay**

هنا تحدد الفترة الزمنية التي تستعملها nmap بين كل إرسال للحزم “فحص” وآخر …

أكيد عارفين شلون تستعملونهم، ولهذا لا حاجة لذكرهم … إن شاء الله يكون الموضوع مفيد لكم وسأعود بالمزيد حول nmap بإذن الله …

[الموضوع للمناقشة موجود هنا](http://www.linuxac.org/forum/showthread.php?35188-Controlling-Nmap-Scan-Speed)
