---
title: "تنصيب سيرفر Nis لإعطاء الصلاحيات HOWTO"
date: 2006-12-26 12:53:31 -0500
categories: ["Linux Services"]
permalink: "/2006/12/26/nis-server-howto/"
reading_time: 6
---

**السلام عليكم ورحمة الله وبركاته**

الموضوع من كتاباتي أيام عرب نيكس نقلته لكم للفائدة العامة …

أخوتي بالله كما وعدتكم بكل جديد ها أنا اليوم اضع لكم الشرح المفصل لتنصيب سيرفر ال NIS والتي هي Name Information Server أو Service التي تعني سيرفر دعم المعلومات والتي تقوم بإعطاء المعلومات الكاملة للأعضاء من خلالها وتحدد صلاحيات كل عضو على الشبكة ماذا يمكن أن يعمل. طبعاً تعتبر هذه السيرفر هي رديفة أو المشابهة لخدمة ال Active Directory بالنسبة لمستعملي الوندوز وكما ذكرت لكم هي التي تعطي وتحدد صلاحيات المستخدمين. طبعاً طريقة تنصيب هذه السيرفر هو جابنين, الأول تنصيب السيرفر والثاني تنصيب المستخدم للسيرفر. لهذا أخوتي سأبدأ بتنصيب السيرفر أولاً ثم ندخل مباشرتاً الى تنصيب المستخدم بعد ذلك في رد منفصل. على بركة الله نبدأ:

أول شيء عليك القيام به لكي لا تحصل عندنا مشاكل كبيرة لاحقاً قم بإغلاق ال iptables التي هي تابعة للجدار الناري من خلال الأمر التالي:

service iptables stop

الآن قم بفتح الملف network من خلال تنفيذ الأمر التالي:

vi /etc/sysconfig/network

ومن ثم قم بإضافة أسم الدومين domain الخاص بك في السطر التالي:

NISDOMAIN=arabnix.net

أنا هنا الدومين عندي هو arabnix.net أنت قم بوضع أسم الدومين الذي تريد والموجود عندك. طبعا بعد الإنتهاء من هذا الملف وحفظه سيتم تفعيل هذا الدومين بعد عمل إعادة تشغيل للجهاز أو يمكنك عمل ذلك من خلال الأمر التالي:

domainname arabnix.net

هذا الأمر لا يتطلب إعادة تشغيل لتفعيل الدومين ولكن يعمل بشكل مؤقت أي بمجرد إعادة التشغيل سيتم مسح أسم الدومين الذي وضعته ولهذا قمنا بتثبيته لكي يتم تثبيت القيمة حتى بعد إعادة التشغيل.

الآن عليك أن تحدد الشبكات التي ممكن تعمل إتصال access على سيرفر ال NIS هذا من خلال تحرير الملف securenets من خلال الأمر التالي:

vi /var/yp/securenets

وتضع فيه أرقام الأي بي الخاص بالشبكات المسموحة مثل ما يلي:

> 127.0.0.1 255.255.255.255 172.16.0.0 255.255.0.0

ملاحظة:-

نظام ال nis مثله مثل نظام ال nfs والذي هو Network File Server والذي سأشرح تنصيبه لكم لاحقاً إن شاء الله, يعتمد بشكل كلي على خدمة أسمها portmap. وظيفة هذه الخدمة هي فتح بورت معين لكي يتم الإتصال بين السيرفر والمستخدم لخدمة ال nis مثلاً طبعاً يقوم بها من خلال تحديد رقم port أعلى من الأرقام المحجوزة والمتعارف عليها مثل بورت 80 للبروتوكول http وهكذا.

للتأكد من عمل هذه الخدمة نفذ الأمر التالي:

service portmap status

أذا وجدتها تعمل ممتاز, إذا لا قم بتنفيذ الأوامر التالية:

service portmap start

chkconfig portmap start

السطر الأول يشغلها والسطر الثاني يضيفها الى ال run levels لكي تعمل حتى بعد عمل إعادة تشغيل أو الدخول الى مستوى تشغيلي آخر.

الآن يجب أن نشغل برنامج أو خدمة ال nis من خلال تنفيذ الاوامر التالية:

service ypserv start

chkconfig ypserv on

السطر الأول يشغلها والسطر الثاني يضيفها الى ال run levels لكي تعمل حتى بعد عمل إعادة تشغيل أو الدخول الى مستوى تشغيلي آخر.

ملاحظة:-

أكيد سيخطر على بال بعضكم لماذا yp : ؟ صح أكيد ؟ طبعاً yp هي عبارة عن Yellow Pages التي كان ولا يزال أنظمة اليونكس يستعملونها والتي جاءت فكرتها من الصفحات الصفراء الخاصة بدليل الهاتف التي تعطي المعلومات عن الأشخاص. لهذا بقيت كما هي yp بدل من كلمة nis مثلاً.

الآن قم بتحرير ملف Makefile من خلال الأمر التالي:

vi /var/yp/Makefile

وأبحص عن العبارة :all وأجعلها كالتالي:

> all: passwd group hosts netid

الآن قربنا من الإنتهاء من تنصيب السيرفر سهل صح ؟ أشربلك فنجان قهوة لكي تكمل lotsocoffee_smiley ماشي نكمل. لبناء قاعدة البيانات الخاصة بالسيرفر NIS نقوم بتنفيذ الأمر التالي:

/usr/lib/yp/ypinit -m

الآن قم بتشغيل خدمة ال rc.yppasswdd التي تسمح للمستخدم بتغيير كلمة السر له من خلال جهازه, ويتم التغيير على السيرفر ال NIS. نفذ الأمر التالي:

service yppasswdd start

chkconfig yppasswdd on

كما ذكرت سابقاً, السطر الأول يشغلها والسطر الثاني يضيفها الى ال run levels لكي تعمل حتى بعد عمل إعادة تشغيل أو الدخول الى مستوى تشغيلي آخر.

الحين أقول لك ألف مبروك تم تنصيب سيرفر ال NIS على جهازك السيرفر ولكي تتأكد من ذلك نفذ الأوامر التالية:

الأمر الأول لفحص إن جميع خدمات ال yp تعمل:

ps auxf | grep yp

الأمر الثاني للتأكد من ربط خدمة ال NIS مع البورت ماب portmap:

rpcinfo -p localhost

الأمر الثالث والأخير للتأكد من خلوا جميع العملية من أخطاء أفتح ملف

vi /var/log/messages

وتأكد أنه لا يوجد في آخره أي مشكلة عن السيرفر الذي عملته من خلال ملاحظتك للنتائج التي كتبت في هذا الملف. طبعاً قلت لكم أبحثوا في الآخير وذلك على إعتبار إنه آخر ما قمتم به هو تنصيب ال NIS.

الآن أقدر أرجع وأقول لكم ألف مبروك التنصيب ولكي تتمكنوا من العمل عليها عليكم إتباع الدرس القادم والذي يخص تنصيب المستخدم client لهذا اليوم عليكم أن تقرءوا كثيراً

الدرس الثاني هو تنصيب ال NIS Client:

أولا يجب أن تكون منصب البرامج التالية:

* portmap

* ypbind

* yptools

* authconfig

* authconfig-gtk

ثانياً نقوم بتشغيل برنامج التالي:

system-config-authentication

قم بإختيار Enable NIS Support على صفحة معلومات المستخدم User Information. الآن قم بالضغط على Configure NIS الآن في شاشة اعدادات ال NIS ضع الدومين الذي تريده أن يعمل لل NIS والذي عملته في الدرس السابق وضع أسم السيرفر الذي موجود عليه ال NIS Server بعد ذلك قم بالضغط على OK.

الآن المفروض تم تشغيل خدمة ال ypbind الخاصة بال NIS بنجاح. أذا لم يتم ذلك ممكن التأكد من ذلك من خلال النظر الى المجلد التالي:

/var/log/messages

الآن عليك أن تعمل إعادة تشغيل للخدمة sshd من خلال الأمر التالي:

service sshd restart

الآن نأتي الى فحص ال NIS Client مستخدم ال NIS يعني من خلال التالي:

أولاً نفذ الأمر الذي بالأسفل يجب أن يرجع لك أسم ال NIS Server:

ypwhich

الآن قم بتنفيذ الأمر الذي بالأسفل المفروض يرجع لك جميع الأعضاء المسجلين على السيرفر والذي رقمه يتجاوز ال 500:

ypcat passwd

الآن نفذ الأمر الذي بالأسفل لكي تحصل على جميع المستخدمين الموجودين عندك محلياً والمسجلين في ملف

/etc/passwd

وأيضا تحصل على معلومات من خدمة ال NIS map الخاصة بكلمات السر.

الآن قم بعمل مستخدم على جهاز المحطة ومستخدم على جهاز الخادم وعلى أن يكون كلاهما مختلف عن الآخر واعطي لكل واحد كلمة سر, نفذ التالي على المحطة:

useradd -u 1024 luser passwd luser

نفذ التالي على الخادم:

useradd -u 1025 suser passwd suser

الأول هو المستخدم الذي ستستعمله على المحطة والثاني سنستعمله على الخادم. بعد ذلك تأكد من إمكانيتك للدخول على النظام بإستعمال هذين المستخدمين, طبعا الأول تتأكد من على المحطة والثاني على الخادم. بعد ذلك حاول أن تدخل على المحطة من خلال المستخدم suser الي هو المستخدم الموجود على الخادم, طبعاً لن يسمح لك بذلك لأنه لم يتم إضافة المعلومات الخاصة بهذا العضو على NIS map الخاصة بكلمات السر. للتأكد من ذلك نفذ الأمر التالي:

ypcat passwd

بعد ذلك أذهب الى المجلد

cd /var/yp

ونفذ الأمر

make

الآن أرجع على المحطة وحاول الدخول من خلال المستخدم suser من جديد ستتمكن من الدخول على النظام وذلك لأنه قاعدة البيانات الخاصة بالكلمات السرية تم إعادة بناءها وتم إضافة المستخدم الجديد أليها. وللتأكد من ذلك نفذ الأمر

ypcat passwd

الى هنا نأتي الى نهاية تنصيب سيرفر ال NIS وأتمنى أن أكون قد وفقت في شرحها لكم

وأنتظروني في تكلمة على هذا الدرس وهو كيفية عمل مجلد Home لكل مستخدم يدخل من ال NIS

أخوكم B!n@ry …
